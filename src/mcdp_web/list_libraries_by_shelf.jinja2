{%  from 'add_library_button.jinja2' import add_library_button with context %}
<style>
ul.libraries_by_shelf
{
    list-style: none;
    padding: 0;
}
ul.libraries_by_shelf  ul {
    list-style: none;
    padding-left: 1em;
}

ul.libraries_by_shelf > li > *:first-child:before {
    content: '{{icon_shelf|safe}}';
    margin-right: 0.5em;
}

ul.libraries_by_shelf  ul > li > *:first-child:before {
    content: '{{icon_library|safe}}';
    margin-right: 0.5em;
}

</style>
<ul class='libraries_by_shelf'>
    {% for sname, shelf in navigation['shelves_used'].items() %}
        <li>

        <a href='{{root}}/shelves/{{sname}}/'><code>{{sname}}</code></a>

            {% if shelf.get_libraries_path() %}
            <ul>
            {% for libname in shelf.get_libraries_path() %}
                <li><a href="{{root}}/libraries/{{libname}}/"><code><span>{{libname}}</span></code></a> </li>
            {% endfor %}
            </ul>
            {% else %}
            <p>(No libraries)</p>
            {% endif %}

            {% if shelf_can_write(sname) %}
            <p>{{add_library_button(sname)}}</p>
            {%endif%}

        </li>
    {% endfor %}
</ul>
