
<pre><code><span class='BuildProblem'><span class='MCDPKeyword'>mcdp</span> {  
    <span class="comment"># We need to fly for this duration</span>
    <span class='FunStatement'><span class='ProvideKeyword'>provides</span><span class='FName'> endurance</span> [<span class='Unit'>s</span>]</span> 
    <span class="comment"># While carrying this payload</span>
    <span class="comment"># (in addition to battery)</span>
    <span class='FunStatement'><span class='ProvideKeyword'>provides</span><span class='FName'> extra_payload</span> [<span class='Unit'>kg</span>]</span>
    <span class="comment"># And providing this extra power</span>
    <span class='FunStatement'><span class='ProvideKeyword'>provides</span><span class='FName'> extra_power</span> [<span class='Unit'>W</span>]</span>

    <span class="comment"># Sub-design problem: choose the battery</span>
    <span class='SetName'><span class='SubKeyword'>sub</span><span class='DPName'> battery</span> = <span class='DPWrap'><span class='DPWrapToken'>dp</span> {

        <span class='FunStatement'><span class='ProvideKeyword'>provides</span><span class='FName'> capacity</span> [<span class='Unit'>J</span>]</span>
        <span class='ResStatement'><span class='RequireKeyword'>requires</span><span class='RName'> mass</span> [<span class='Unit'>kg</span>]</span>

    <span class='ImplementedbyKeyword'>implemented-by</span> <span class='LoadDP'><span class='LoadKeyword'>load</span><span class='FuncName'> BatteryDP</span></span>
    }</span></span>
    <span class="comment"># Sub-design problem: actuation</span>
    <span class='SetName'><span class='SubKeyword'>sub</span><span class='DPName'> actuation</span> = <span class='AbstractAway'><span class='AbstractKeyword'>abstract</span> <span class='BuildProblem'><span class='MCDPKeyword'>mcdp</span> {
        <span class="comment"># actuators need to provide this lift</span>
        <span class='FunStatement'><span class='ProvideKeyword'>provides</span><span class='FName'> lift</span> [<span class='Unit'>N</span>]</span>
        <span class="comment"># and will require power</span>
        <span class='ResStatement'><span class='RequireKeyword'>requires</span><span class='RName'> power</span> [<span class='Unit'>W</span>]</span>
        <span class="comment"># simple model: quadratic</span>
        <span class='SetNameGeneric'><span class='SetNameGenericVar'>c</span> <span class='eq'>=</span> <span class='SimpleValue'><span class='ValueExpr'>0.002</span> <span class='Unit'>W/N^2</span></span></span>
        <span class='Constraint'><span class='NewResource'>power</span> <span class='geq'>&gt;=</span> <span class='MultN'><span class='VariableRef'>lift</span> <span class='times'>*</span><span class='VariableRef'> lift</span> <span class='times'>*</span><span class='VariableRef'> c</span></span></span>
    }</span></span></span>
    <span class="comment"># Co-design constraint: battery must be large enough</span>
    <span class='SetNameGeneric'><span class='SetNameGenericVar'>power</span> <span class='eq'>=</span> <span class='PlusN'><span class='Resource'><span class='DPName'>actuation</span><span class='DotPrep'>.</span><span class='RName'>power</span></span> <span class='plus'>+</span> <span class='VariableRef'>extra_power</span></span></span>
    <span class='SetNameGeneric'><span class='SetNameGenericVar'>energy</span> <span class='eq'>=</span> <span class='MultN'><span class='VariableRef'>power</span> <span class='times'>*</span><span class='VariableRef'> endurance</span></span></span>
    <span class='Constraint'><span class='Function'><span class='DPName'>battery</span><span class='DotPrep'>.</span><span class='FName'>capacity</span></span> <span class='geq'>&gt;=</span> <span class='VariableRef'>energy</span></span>

    <span class="comment"># Co-design constraint: actuators must be powerful enough</span>
    <span class='SetNameGeneric'><span class='SetNameGenericVar'>gravity</span> <span class='eq'>=</span> <span class='SimpleValue'><span class='ValueExpr'>9.81</span> <span class='Unit'>m/s^2</span></span></span>
    <span class='SetNameGeneric'><span class='SetNameGenericVar'>weight</span> <span class='eq'>=</span> (<span class='MultN'><span class='PlusN'><span class='Resource'><span class='DPName'>battery</span><span class='DotPrep'>.</span><span class='RName'>mass</span></span> <span class='plus'>+</span> <span class='VariableRef'>extra_payload</span></span>) <span class='times'>*</span><span class='VariableRef'> gravity</span></span></span>
    <span class='Constraint'><span class='Function'><span class='DPName'>actuation</span><span class='DotPrep'>.</span><span class='FName'>lift</span></span> <span class='geq'>&gt;=</span> <span class='VariableRef'>weight</span></span>

    <span class="comment"># suppose we want to optimize for size of the battery</span>
    <span class='ResShortcut1'><span class='RequireKeyword'>requires</span><span class='RName'> mass</span> <span class='ForKeyword'>for</span><span class='DPName'> battery</span></span>
}</span>
</code></pre>

<style type="text/css">
 
     span.Unit { color: purple; }
     span.ProvideKeyword, span.FName { color: darkgreen;}
     span.RequireKeyword, span.RName  { color: darkred;}
     
     span.NewResource { color: darkred;}
     span.ValueExpr { color: #CC6600 ;}
     /*span.Function  { color: darkgreen;}*/
span.ProvideKeyword,
span.RequireKeyword,     
       span.MCDPKeyword,
       span.SubKeyword,
    span.CompactKeyword,
    span.AbstractKeyword,
    span.TemplateKeyword,
    span.ForKeyword,
    span.UsingKeyword,
    span.RequiredByKeyword,
    span.ProvidedByKeyword,
    span.LoadKeyword,
    span.CodeKeyword,
    span.leq, span.geq, span.OpKeyword, span.eq, span.plus, span.times, span.DPWrapToken,
    span.ImplementedbyKeyword , span.FromCatalogueKeyword
       { font-weight: bold; }
       
    span.ImpName { color: #CC6600; }
    span.FuncName { color: #CC6600 ; }

       span.MCDPKeyword,
       span.SubKeyword,
    span.CompactKeyword,
    span.AbstractKeyword,
    span.TemplateKeyword,
    span.ForKeyword,
    span.UsingKeyword,
    span.RequiredByKeyword,
    span.ProvidedByKeyword,
    span.LoadKeyword, span.CodeKeyword,
    span.leq, span.geq, span.OpKeyword, span.eq, span.plus, span.times, span.DPWrapToken,
    span.ImplementedbyKeyword,  span.FromCatalogueKeyword 
    {
       color: #00a;}
     span.FName, span.RName { } /*font-style: italic;}*/
     span.DPName { font-style: italic; }
     span.comment { color: grey;}


</style>

